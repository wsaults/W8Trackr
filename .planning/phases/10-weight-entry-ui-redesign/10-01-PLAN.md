---
phase: 10-weight-entry-ui-redesign
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - W8Trackr/Views/Components/WeightAdjustmentButton.swift
  - W8Trackr/Views/WeightEntryView.swift
  - W8Trackr/Views/Onboarding/FirstWeightStepView.swift
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Weight adjustment buttons use plus/minus icons (not media transport icons)"
    - "Each button shows its increment value (+1, +0.1, -1, -0.1)"
    - "Large increments use filled icons, small increments use outline icons"
    - "VoiceOver announces button purpose and increment amount"
    - "All buttons meet 44pt minimum touch target"
  artifacts:
    - path: "W8Trackr/Views/Components/WeightAdjustmentButton.swift"
      provides: "Reusable weight adjustment button component"
      exports: ["WeightAdjustmentButton"]
    - path: "W8Trackr/Views/WeightEntryView.swift"
      provides: "Updated weight entry view using new button"
      contains: "WeightAdjustmentButton"
    - path: "W8Trackr/Views/Onboarding/FirstWeightStepView.swift"
      provides: "Updated onboarding view using new button"
      contains: "WeightAdjustmentButton"
  key_links:
    - from: "WeightEntryView.swift"
      to: "WeightAdjustmentButton.swift"
      via: "import and usage"
      pattern: "WeightAdjustmentButton\\("
    - from: "FirstWeightStepView.swift"
      to: "WeightAdjustmentButton.swift"
      via: "import and usage"
      pattern: "WeightAdjustmentButton\\("
---

<objective>
Redesign weight entry controls with intuitive plus/minus icons and visible increment labels.

Purpose: Current media transport icons (backward.circle.fill, forward.circle.fill) are semantically confusing for weight adjustment. Users expect plus/minus icons for increment/decrement actions.

Output: A unified WeightAdjustmentButton component used by both WeightEntryView and FirstWeightStepView, with proper visual hierarchy, accessibility labels, and increment visibility.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-weight-entry-ui-redesign/10-RESEARCH.md

# Existing implementation (to be modified)
@W8Trackr/Views/WeightEntryView.swift
@W8Trackr/Views/Onboarding/FirstWeightStepView.swift

# Design system reference
@W8Trackr/Theme/Colors.swift

# Data model reference (for WeightUnit)
@W8Trackr/Models/WeightEntry.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create unified WeightAdjustmentButton component</name>
  <files>W8Trackr/Views/Components/WeightAdjustmentButton.swift</files>
  <action>
Create a new reusable component at W8Trackr/Views/Components/WeightAdjustmentButton.swift with the following design:

**Component signature:**
```swift
struct WeightAdjustmentButton: View {
    let amount: Double        // e.g., 1.0 or 0.1
    let unitLabel: String     // e.g., "lb" or "kg"
    let isIncrease: Bool      // true for +, false for -
    let action: () -> Void
}
```

**Visual design:**
- Icon: plus.circle.fill / plus.circle for increase, minus.circle.fill / minus.circle for decrease
- Filled icons for large increments (amount >= 1.0), outline for small (0.1)
- Color: AppColors.primary for large increments, AppColors.secondary for small
- Label below icon showing increment: "+1" / "-1" / "+0.1" / "-0.1"
- Use @ScaledMetric for icon size (base 44pt) and label size (base 12pt)

**Accessibility:**
- accessibilityLabel: "[Increase/Decrease] by [amount] [unit]" (e.g., "Decrease by 1 pound")
- accessibilityHint: "Double-tap to adjust weight"

**Implementation notes:**
- Use .foregroundStyle() not .foregroundColor() (deprecated)
- Icon name logic: isIncrease determines plus/minus, amount >= 1.0 determines filled/outline
- Format amount with .formatted() for locale-aware display
- VStack with Image and Text, spacing 4

Include a preview with all four button states.
  </action>
  <verify>
File exists at W8Trackr/Views/Components/WeightAdjustmentButton.swift
Build succeeds: `xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build 2>&1 | tail -5`
  </verify>
  <done>WeightAdjustmentButton component exists with plus/minus icons, increment labels, and VoiceOver support</done>
</task>

<task type="auto">
  <name>Task 2: Update WeightEntryView to use new component</name>
  <files>W8Trackr/Views/WeightEntryView.swift</files>
  <action>
Replace the existing weight adjustment buttons in WeightEntryView with the new WeightAdjustmentButton component.

**Changes to make:**

1. Remove the local `WeightAdjustButton` struct (lines 11-27) - this will be replaced by the new shared component

2. Update the adjustment buttons section (lines 144-180) to use WeightAdjustmentButton:

```swift
HStack(spacing: 24) {
    WeightAdjustmentButton(amount: 1.0, unitLabel: weightUnit.rawValue, isIncrease: false) {
        mediumFeedbackGenerator.impactOccurred()
        weight = max(weightUnit.minWeight, weight - 1.0)
    }

    WeightAdjustmentButton(amount: 0.1, unitLabel: weightUnit.rawValue, isIncrease: false) {
        lightFeedbackGenerator.impactOccurred()
        weight = max(weightUnit.minWeight, weight - 0.1)
    }

    WeightAdjustmentButton(amount: 0.1, unitLabel: weightUnit.rawValue, isIncrease: true) {
        lightFeedbackGenerator.impactOccurred()
        weight = min(weightUnit.maxWeight, weight + 0.1)
    }

    WeightAdjustmentButton(amount: 1.0, unitLabel: weightUnit.rawValue, isIncrease: true) {
        mediumFeedbackGenerator.impactOccurred()
        weight = min(weightUnit.maxWeight, weight + 1.0)
    }
}
```

3. Reduce spacing from 40 to 24 (buttons now have labels so need less gap)

**Do NOT change:**
- TextField behavior
- Haptic feedback logic
- Weight validation
- Save functionality
- Any other sections of the view
  </action>
  <verify>
Build succeeds: `xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build 2>&1 | tail -5`
No references to backward.circle or forward.circle remain: `grep -r "backward\\.circle\|forward\\.circle" W8Trackr/Views/WeightEntryView.swift || echo "Clean"`
  </verify>
  <done>WeightEntryView uses WeightAdjustmentButton with plus/minus icons and visible increment labels</done>
</task>

<task type="auto">
  <name>Task 3: Update FirstWeightStepView to use shared component</name>
  <files>W8Trackr/Views/Onboarding/FirstWeightStepView.swift</files>
  <action>
Replace the local WeightStepButton with the shared WeightAdjustmentButton component.

**Changes to make:**

1. Remove the private `WeightStepButton` struct (lines 121-133) - no longer needed

2. Update the adjustment buttons section (lines 60-80) to use WeightAdjustmentButton:

```swift
HStack(spacing: 24) {
    WeightAdjustmentButton(amount: 1.0, unitLabel: weightUnit.rawValue, isIncrease: false) {
        mediumFeedbackGenerator.impactOccurred()
        enteredWeight = max(weightUnit.minWeight, enteredWeight - 1.0)
    }

    WeightAdjustmentButton(amount: 0.1, unitLabel: weightUnit.rawValue, isIncrease: false) {
        lightFeedbackGenerator.impactOccurred()
        enteredWeight = max(weightUnit.minWeight, enteredWeight - 0.1)
    }

    WeightAdjustmentButton(amount: 0.1, unitLabel: weightUnit.rawValue, isIncrease: true) {
        lightFeedbackGenerator.impactOccurred()
        enteredWeight = min(weightUnit.maxWeight, enteredWeight + 0.1)
    }

    WeightAdjustmentButton(amount: 1.0, unitLabel: weightUnit.rawValue, isIncrease: true) {
        mediumFeedbackGenerator.impactOccurred()
        enteredWeight = min(weightUnit.maxWeight, enteredWeight + 1.0)
    }
}
```

3. Reduce spacing from 40 to 24 (consistency with WeightEntryView)

**Do NOT change:**
- Animation logic (showContent)
- Continue button behavior
- Default weight initialization
- Any layout outside the buttons section
  </action>
  <verify>
Build succeeds: `xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build 2>&1 | tail -5`
No references to backward.circle or forward.circle remain: `grep -r "backward\\.circle\|forward\\.circle" W8Trackr/Views/Onboarding/FirstWeightStepView.swift || echo "Clean"`
No WeightStepButton struct remains: `grep "struct WeightStepButton" W8Trackr/Views/Onboarding/FirstWeightStepView.swift || echo "Removed"`
  </verify>
  <done>FirstWeightStepView uses shared WeightAdjustmentButton, WeightStepButton removed</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Build verification:**
   ```bash
   xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build
   ```
   Must complete with BUILD SUCCEEDED

2. **No media icons remain:**
   ```bash
   grep -r "backward\.circle\|forward\.circle" W8Trackr/Views/
   ```
   Should return no matches

3. **Component reuse verified:**
   ```bash
   grep -l "WeightAdjustmentButton" W8Trackr/Views/
   ```
   Should show both WeightEntryView.swift and FirstWeightStepView.swift

4. **SwiftLint clean:**
   ```bash
   swiftlint lint W8Trackr/Views/Components/WeightAdjustmentButton.swift W8Trackr/Views/WeightEntryView.swift W8Trackr/Views/Onboarding/FirstWeightStepView.swift
   ```
   No new warnings introduced
</verification>

<success_criteria>
1. Weight adjustment buttons display plus/minus icons (not media transport icons)
2. Each button shows its increment value below the icon (+1, +0.1, -1, -0.1)
3. Large increment buttons (1.0) use filled icons with AppColors.primary
4. Small increment buttons (0.1) use outline icons with AppColors.secondary
5. VoiceOver announces "Increase/Decrease by [amount] [unit]" for each button
6. Touch targets remain at least 44pt
7. Both WeightEntryView and FirstWeightStepView use the shared component
8. Build succeeds with no new warnings
</success_criteria>

<output>
After completion, create `.planning/phases/10-weight-entry-ui-redesign/10-01-SUMMARY.md`
</output>
