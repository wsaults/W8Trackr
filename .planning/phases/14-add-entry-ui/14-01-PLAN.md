---
phase: 14-add-entry-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - W8Trackr/Views/ContentView.swift
  - W8Trackr/Views/Dashboard/DashboardView.swift
  - W8Trackr/Views/SummaryView.swift
autonomous: true

must_haves:
  truths:
    - "Add entry button appears as tab bar bottom accessory on all tabs"
    - "Button has Liquid Glass capsule styling (automatic from iOS 26)"
    - "Tapping button presents WeightEntryView as modal sheet"
    - "Tab bar minimizes when scrolling down in dashboard content"
    - "Accessory slides inline when tab bar minimizes"
    - "No floating action button visible on dashboard"
  artifacts:
    - path: "W8Trackr/Views/ContentView.swift"
      provides: "Tab bar accessory with add button"
      contains: ".tabViewBottomAccessory"
    - path: "W8Trackr/Views/ContentView.swift"
      provides: "Minimize behavior"
      contains: ".tabBarMinimizeBehavior"
    - path: "W8Trackr/Views/Dashboard/DashboardView.swift"
      provides: "Dashboard without FAB"
      excludes: "fabButton"
    - path: "W8Trackr/Views/SummaryView.swift"
      provides: "SummaryView without FAB"
      excludes: "fabButton"
  key_links:
    - from: "ContentView.swift"
      to: "WeightEntryView"
      via: ".sheet(isPresented:)"
      pattern: "\\.sheet.*showAddWeightView"
    - from: "ContentView.swift"
      to: "TabView"
      via: ".tabViewBottomAccessory"
      pattern: "\\.tabViewBottomAccessory"
---

<objective>
Replace the floating action button (FAB) with iOS 26 Liquid Glass tab bar bottom accessory for adding weight entries.

Purpose: Modernize the add entry experience to use iOS 26 native tab bar accessory pattern (like Apple Music's Now Playing control), providing better integration with the tab bar and automatic Liquid Glass styling.

Output: Tab bar has a plus button accessory that presents WeightEntryView, FAB removed from dashboard.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-add-entry-ui/14-CONTEXT.md
@.planning/phases/14-add-entry-ui/14-RESEARCH.md

# Current implementation files
@W8Trackr/Views/ContentView.swift
@W8Trackr/Views/Dashboard/DashboardView.swift
@W8Trackr/Views/SummaryView.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add tab bar bottom accessory to ContentView</name>
  <files>W8Trackr/Views/ContentView.swift</files>
  <action>
    Modify ContentView.swift to add iOS 26 tab bar accessory:

    1. Add state for sheet presentation:
       ```swift
       @State private var showAddWeightView = false
       ```

    2. Apply `.tabViewBottomAccessory` modifier to TabView with plus button:
       ```swift
       .tabViewBottomAccessory {
           Button {
               showAddWeightView = true
           } label: {
               Image(systemName: "plus")
                   .font(.title2)
                   .fontWeight(.semibold)
           }
           .accessibilityLabel("Add weight entry")
           .accessibilityHint("Opens form to log a new weight measurement")
       }
       ```

    3. Apply `.tabBarMinimizeBehavior(.onScrollDown)` to TabView

    4. Add `.sheet(isPresented:)` modifier at TabView level:
       ```swift
       .sheet(isPresented: $showAddWeightView) {
           WeightEntryView(entries: entries, weightUnit: preferredWeightUnit)
       }
       ```

    Important notes from RESEARCH.md:
    - The accessory modifier must be on the TabView, not individual tabs
    - Let Liquid Glass provide capsule background automatically (no custom styling)
    - Sheet modifier should be at same level as TabView for proper presentation
    - ContentView already has @Query for entries and @AppStorage for preferredWeightUnit

    Do NOT add custom background, blur, or capsule styling to the button - iOS 26 Liquid Glass handles this automatically.
  </action>
  <verify>
    Build succeeds:
    ```bash
    xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build 2>&1 | tail -20
    ```

    Check modifiers are applied:
    ```bash
    grep -n "tabViewBottomAccessory\|tabBarMinimizeBehavior\|showAddWeightView" W8Trackr/Views/ContentView.swift
    ```
  </verify>
  <done>
    ContentView has tab bar bottom accessory with plus button, minimize behavior on scroll, and sheet presentation for WeightEntryView.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove FAB from DashboardView and SummaryView</name>
  <files>W8Trackr/Views/Dashboard/DashboardView.swift, W8Trackr/Views/SummaryView.swift</files>
  <action>
    Remove the floating action button from both views:

    **DashboardView.swift:**
    1. Remove `@State private var showAddWeightView = false` (no longer needed)
    2. Remove the entire `fabButton` computed property (lines ~208-223)
    3. Remove `fabButton` usage from the ZStack body (lines ~100-104)
    4. Remove `.sheet(isPresented: $showAddWeightView)` modifier (now in ContentView)
    5. Remove bottom padding on MilestoneHistoryView and Spacer that was making room for FAB:
       - Change `.padding(.bottom, 80)` to `.padding(.bottom)` or remove entirely
       - Remove the `Spacer().frame(height: 80)` in the else branch
    6. Keep the `showAddWeightView = true` in EmptyStateView action - this needs updating to use a callback

    For EmptyStateView in DashboardView, the "Log Your First Weight" button needs to trigger the sheet at ContentView level. Options:
    - Pass a binding down: Add `@Binding var showAddWeightView: Bool` parameter to DashboardView
    - Use the pattern from current code and pass the binding through

    Update DashboardView signature to accept the binding:
    ```swift
    @Binding var showAddWeightView: Bool
    ```

    Update ContentView to pass the binding:
    ```swift
    DashboardView(
        showAddWeightView: $showAddWeightView,  // Add this
        entries: entries,
        // ... rest of parameters
    )
    ```

    **SummaryView.swift:**
    1. Remove `@State private var showAddWeightView = false`
    2. Remove the FAB Button (lines ~101-112)
    3. Remove `.sheet(isPresented: $showAddWeightView)` modifier

    Note: SummaryView is not in the active TabView (replaced by DashboardView), but clean it up for consistency. If SummaryView's EmptyStateView needs to trigger add, it would need the same binding pattern, but since it's unused, just remove the FAB and sheet.
  </action>
  <verify>
    Build succeeds:
    ```bash
    xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build 2>&1 | tail -20
    ```

    No FAB references remain:
    ```bash
    grep -rn "fabButton" W8Trackr/Views/ && echo "FAB references found!" || echo "No FAB references - GOOD"
    ```

    No orphaned showAddWeightView state in DashboardView/SummaryView:
    ```bash
    grep -n "showAddWeightView" W8Trackr/Views/Dashboard/DashboardView.swift W8Trackr/Views/SummaryView.swift
    ```
    (Should only show @Binding usage in DashboardView, nothing in SummaryView)
  </verify>
  <done>
    FAB removed from DashboardView and SummaryView. DashboardView accepts showAddWeightView binding for EmptyStateView action. No bottom padding reserved for FAB.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **Build verification:**
   ```bash
   xcodebuild -project W8Trackr.xcodeproj -scheme W8Trackr -configuration Debug -sdk iphonesimulator build
   ```

2. **SwiftLint passes:**
   ```bash
   swiftlint lint --path W8Trackr/Views/ContentView.swift W8Trackr/Views/Dashboard/DashboardView.swift W8Trackr/Views/SummaryView.swift --quiet
   ```

3. **API usage verification:**
   ```bash
   # Tab bar accessory is applied
   grep -q "tabViewBottomAccessory" W8Trackr/Views/ContentView.swift && echo "PASS: accessory" || echo "FAIL: accessory"

   # Minimize behavior is applied
   grep -q "tabBarMinimizeBehavior" W8Trackr/Views/ContentView.swift && echo "PASS: minimize" || echo "FAIL: minimize"

   # No FAB in dashboard
   grep -q "fabButton" W8Trackr/Views/Dashboard/DashboardView.swift && echo "FAIL: FAB still in dashboard" || echo "PASS: FAB removed"
   ```
</verification>

<success_criteria>
- [ ] ContentView has `.tabViewBottomAccessory()` modifier with plus button
- [ ] ContentView has `.tabBarMinimizeBehavior(.onScrollDown)` modifier
- [ ] ContentView presents WeightEntryView via `.sheet(isPresented:)`
- [ ] DashboardView has no FAB button or fabButton computed property
- [ ] DashboardView accepts binding for showAddWeightView for EmptyStateView
- [ ] SummaryView has no FAB button
- [ ] No extra bottom padding reserved for FAB in dashboard content
- [ ] Build succeeds with no errors
- [ ] SwiftLint passes with no new violations
</success_criteria>

<output>
After completion, create `.planning/phases/14-add-entry-ui/14-01-SUMMARY.md`
</output>
