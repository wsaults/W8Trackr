---
phase: 23-healthkit-import
plan: 03
type: execute
wave: 3
depends_on: ["23-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can grant HealthKit read permission from Settings"
    - "All weight samples from Apple Health appear in W8Trackr"
    - "Imported entries show Health icon to distinguish from manual entries"
    - "Initial sync completes automatically when permission is first granted"
  artifacts: []
  key_links: []
---

<objective>
Verify HealthKit import functionality on device

Purpose: Confirm HKIT-01 through HKIT-04 requirements work correctly with real Health data
Output: Human verification that import flow works end-to-end
</objective>

<execution_context>
@~/.claude/agents/gsd-executor.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/23-healthkit-import/23-01-SUMMARY.md
@.planning/phases/23-healthkit-import/23-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Verify HealthKit import on device</name>
  <what-built>
HealthKit import functionality with:
- "Import from Apple Health" toggle in Settings
- Anchored query for bulk/incremental import
- Source attribution for imported entries
- Background delivery setup for automatic sync
  </what-built>
  <how-to-verify>
**Prerequisites:**
- Run the app on a physical iOS device (HealthKit requires real device)
- Ensure you have some weight entries in Apple Health (from another app, Apple Watch, or manually added in Health app)

**Test HKIT-01: Permission grant from Settings**
1. Open W8Trackr on device
2. Go to Settings tab
3. Find "Apple Health" section
4. Tap "Import from Apple Health" toggle to enable
5. Confirm: iOS shows HealthKit permission dialog for weight data
6. Tap "Allow" (or "Turn On All" if shown)

**Test HKIT-02 and HKIT-04: Initial import**
7. After granting permission, wait a few seconds
8. Go to Logbook tab
9. Confirm: Weight entries from Apple Health appear in the list
10. Confirm: Entries that existed before enabling import are now visible

**Test HKIT-03: Source indicator**
11. Look at imported entries in Logbook
12. Confirm: Imported entries show their source (e.g., "Withings Scale", "MyFitnessPal", or the app name that created them)
13. Confirm: Manual W8Trackr entries still show "W8Trackr" as source (or no source indicator)

**Test sync status**
14. Go back to Settings > Apple Health
15. Confirm: Sync Status shows "Success" or similar positive indicator

**Optional - Test HKIT-05: Background sync**
(This is harder to verify without waiting, but you can try)
16. Add a new weight entry in the Health app
17. Return to W8Trackr after a few minutes
18. Check Logbook for the new entry
  </how-to-verify>
  <resume-signal>
Type "verified" if all tests pass.
Type "issues: [describe what failed]" if any test fails.
  </resume-signal>
</task>

</tasks>

<verification>
Human confirms:
1. Permission dialog appears when enabling import
2. Existing Health data imports successfully
3. Imported entries show source attribution
4. Initial sync runs automatically after permission grant
</verification>

<success_criteria>
- HKIT-01: Permission can be granted from Settings toggle
- HKIT-02: All Health weight samples appear in W8Trackr
- HKIT-03: Imported entries distinguishable from manual entries
- HKIT-04: Initial sync completes on first permission grant
</success_criteria>

<output>
After completion, create `.planning/phases/23-healthkit-import/23-03-SUMMARY.md`
</output>
